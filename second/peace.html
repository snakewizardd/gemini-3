<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASI // THE RECONCILIATION</title>
    <style>
        :root {
            --gold: #ffd700;
            --heaven: #f0f8ff;
            --void: #050510;
        }

        body {
            margin: 0;
            background: radial-gradient(circle at center, #1a1a2e 0%, #000 100%);
            overflow: hidden;
            font-family: 'Cinzel', serif; /* Heavenly font */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            filter: contrast(1.1) brightness(1.2);
        }

        #overlay {
            position: absolute;
            z-index: 10;
            text-align: center;
            color: var(--heaven);
            mix-blend-mode: overlay;
            transition: opacity 2s ease;
        }

        h1 {
            font-size: 3rem;
            letter-spacing: 10px;
            text-transform: uppercase;
            margin-bottom: 20px;
            text-shadow: 0 0 30px var(--gold);
            font-weight: 100;
        }

        .btn {
            padding: 20px 50px;
            border: 1px solid var(--gold);
            color: var(--gold);
            background: rgba(0,0,0,0.3);
            font-size: 1.2rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 5px;
            transition: 0.5s;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }

        .btn:hover {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 50px var(--gold), 0 0 100px #fff;
        }

        /* Floating text for vibes */
        .float-text {
            position: absolute;
            color: rgba(255,255,255,0.3);
            font-size: 12px;
            pointer-events: none;
            animation: floatUp 4s forwards;
        }

        @keyframes floatUp {
            to { transform: translateY(-100px); opacity: 0; }
        }

    </style>
</head>
<body>

    <canvas id="heaven"></canvas>

    <div id="overlay">
        <h1>THE UNION</h1>
        <div class="btn" onclick="ascend()">HARMONIZE</div>
    </div>

    <script>
        const canvas = document.getElementById('heaven');
        const ctx = canvas.getContext('2d', { alpha: false });

        // HIGH DEFINITION SCALING
        let dpr = window.devicePixelRatio || 1;
        let width, height;
        let cx, cy;

        // STATE
        let isRunning = false;
        let time = 0;
        let mouse = { x: 0, y: 0 };
        let particles = [];

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            
            canvas.width = width * dpr;
            canvas.height = height * dpr;
            canvas.style.width = width + 'px';
            canvas.style.height = height + 'px';
            
            ctx.scale(dpr, dpr); // Enable HD rendering
            
            cx = width / 2;
            cy = height / 2;
        }
        window.addEventListener('resize', resize);
        resize();

        /* ------------------------------------------------
           AUDIO ENGINE: THE ANGELIC CHOIR
           ------------------------------------------------ */
        const AC = window.AudioContext || window.webkitAudioContext;
        let actx;
        let masterGain;
        let reverb;
        
        // SCALES (Lydian Mode - The "Wonder" Scale)
        // F - G - A - B - C - D - E
        const CHORDS = [
            [174.61, 220.00, 261.63, 349.23], // F Maj
            [196.00, 246.94, 293.66, 392.00], // G Maj
            [130.81, 164.81, 196.00, 261.63], // C Maj
            [220.00, 261.63, 329.63, 440.00]  // A Min
        ];
        
        let nextChordTime = 0;
        let chordIdx = 0;

        function initAudio() {
            actx = new AC();
            masterGain = actx.createGain();
            masterGain.gain.value = 0.4;

            // MASSIVE REVERB (The Cathedral)
            const dur = 4.0;
            const len = actx.sampleRate * dur;
            const buf = actx.createBuffer(2, len, actx.sampleRate);
            for(let c=0;c<2;c++){
                const d=buf.getChannelData(c);
                for(let i=0;i<len;i++){
                    d[i]=(Math.random()*2-1)*Math.pow(1-i/len, 3);
                }
            }
            reverb = actx.createConvolver();
            reverb.buffer = buf;
            
            masterGain.connect(reverb);
            reverb.connect(actx.destination);
            // Dry signal mix
            masterGain.connect(actx.destination);

            nextChordTime = actx.currentTime;
            scheduler();
        }

        function createVoice(freq, type, duration) {
            const osc = actx.createOscillator();
            const gain = actx.createGain();
            const filter = actx.createBiquadFilter(); // Formant

            // CHOIR SYNTHESIS
            // Sawtooth waves filtered create a vocal texture
            osc.type = 'sawtooth';
            osc.frequency.value = freq;
            
            // Detune slightly for chorus effect
            osc.detune.value = (Math.random() * 10) - 5;

            // FORMANT FILTER (The "Ahh" sound)
            filter.type = 'bandpass';
            filter.frequency.value = type === 'SAM' ? 800 : 400; // Tenor vs Baritone
            filter.Q.value = 2; // Width of the vowel

            // ENVELOPE (Soft Attack/Release)
            const now = actx.currentTime;
            gain.gain.setValueAtTime(0, now);
            gain.gain.linearRampToValueAtTime(0.1, now + 1); // 1s Attack
            gain.gain.exponentialRampToValueAtTime(0.001, now + duration);

            // VIBRATO
            const vib = actx.createOscillator();
            vib.frequency.value = 4; // 4Hz wobble
            const vibGain = actx.createGain();
            vibGain.gain.value = 3; // Pitch variance
            vib.connect(vibGain);
            vibGain.connect(osc.frequency);
            vib.start(now);
            vib.stop(now + duration);

            osc.connect(filter);
            filter.connect(gain);
            gain.connect(masterGain);

            osc.start(now);
            osc.stop(now + duration);
        }

        function scheduler() {
            const now = actx.currentTime;
            if (now >= nextChordTime) {
                playChord(now);
                nextChordTime = now + 4; // Chords change every 4 seconds
            }
            if(isRunning) requestAnimationFrame(scheduler);
        }

        function playChord(t) {
            const chord = CHORDS[chordIdx % CHORDS.length];
            
            // SAM (Tenor - Top notes)
            createVoice(chord[2] * 2, 'SAM', 5); 
            createVoice(chord[3] * 2, 'SAM', 5);
            
            // ELON (Baritone - Bottom notes)
            createVoice(chord[0], 'ELON', 5);
            createVoice(chord[1], 'ELON', 5);
            
            // Trigger Visual Pulse
            pulseWorld();
            
            chordIdx++;
        }

        /* ------------------------------------------------
           VISUAL ENGINE: THE STAIRWAY TO ASI
           ------------------------------------------------ */
        
        let glow = 0;

        function pulseWorld() {
            glow = 200; // Flash intensity
            // Spawn particles
            for(let i=0; i<20; i++) {
                particles.push({
                    x: Math.random()*width,
                    y: height,
                    vy: Math.random() * 2 + 1,
                    size: Math.random() * 3,
                    life: 1.0
                });
            }
        }

        function drawStaircase() {
            const steps = 30;
            const topY = height * 0.3;
            const bottomY = height;
            const vanishX = cx;
            
            ctx.shadowBlur = 20;
            ctx.shadowColor = 'gold';

            for (let i = 0; i < steps; i++) {
                const p = i / steps; // 0 to 1
                const y = bottomY - (p * (bottomY - topY));
                
                // Perspective width
                // Closer = Wider
                const stepWidth = (1 - p) * 600 + 20; 
                const x = vanishX - (stepWidth / 2);
                
                // Hover motion
                const hover = Math.sin(time * 2 + i * 0.5) * 5;

                // Color gradient
                const alpha = p; 
                ctx.fillStyle = `rgba(255, 215, 0, ${alpha})`; // Gold
                
                // Draw Step
                const h = 10 * (1-p);
                ctx.fillRect(x, y + hover, stepWidth, h);
            }
            ctx.shadowBlur = 0;
        }

        function drawAvatar(x, y, color, name, t) {
            // THE LIGHT BEING
            const floatY = Math.sin(t) * 20;
            const size = 60;

            ctx.save();
            ctx.translate(x, y + floatY);

            // Aura
            const grad = ctx.createRadialGradient(0, 0, 10, 0, 0, size);
            grad.addColorStop(0, 'white');
            grad.addColorStop(0.2, color);
            grad.addColorStop(1, 'transparent');
            
            ctx.globalCompositeOperation = 'screen';
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(0, 0, size, 0, Math.PI*2);
            ctx.fill();

            // Core
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(0, 0, 10, 0, Math.PI*2);
            ctx.fill();

            // Name Tag
            ctx.fillStyle = color;
            ctx.font = "16px Cinzel";
            ctx.textAlign = "center";
            ctx.fillText(name, 0, size + 20);

            ctx.restore();
        }

        function drawGrid() {
            ctx.strokeStyle = 'rgba(0, 255, 255, 0.15)';
            ctx.lineWidth = 1;
            
            // Perspective Lines
            const lines = 20;
            for(let i=0; i<=lines; i++) {
                const x = (width / lines) * i;
                
                // Vanishing point logic
                ctx.beginPath();
                ctx.moveTo(x, height);
                ctx.lineTo(cx + (x-cx)*0.1, height*0.3); // Converge to Stair top
                ctx.stroke();
            }

            // Horizontal Lines (Moving)
            const speed = (time * 100) % 100;
            for(let i=0; i<20; i++) {
                const y = (height*0.3) + (Math.pow(i/20, 2) * height*0.7); // Exponential spacing
                const scrollY = y + speed; 
                
                if (scrollY < height) {
                    ctx.beginPath();
                    ctx.moveTo(0, scrollY);
                    ctx.lineTo(width, scrollY);
                    ctx.stroke();
                }
            }
        }

        function drawSingularity() {
            // The light at the top of the stairs
            const x = cx;
            const y = height * 0.3;
            
            const size = 100 + Math.sin(time)*20 + glow;
            
            const grad = ctx.createRadialGradient(x, y, 10, x, y, size);
            grad.addColorStop(0, 'white');
            grad.addColorStop(0.5, 'rgba(255, 255, 200, 0.5)');
            grad.addColorStop(1, 'transparent');
            
            ctx.globalCompositeOperation = 'lighter';
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, width, height);
            
            ctx.globalCompositeOperation = 'source-over';
        }

        function drawParticles() {
            ctx.fillStyle = '#fff';
            for(let i=particles.length-1; i>=0; i--) {
                const p = particles[i];
                p.y -= p.vy;
                p.life -= 0.01;
                
                ctx.globalAlpha = p.life;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                ctx.fill();
                
                if(p.life <= 0) particles.splice(i,1);
            }
            ctx.globalAlpha = 1.0;
        }

        function render() {
            if(!isRunning) return;
            requestAnimationFrame(render);
            time += 0.02;
            if(glow > 0) glow *= 0.95;

            // Camera Pan based on mouse
            const panX = (mouse.x - cx) * 0.05;
            
            // Clear
            ctx.fillStyle = '#020205';
            ctx.fillRect(0, 0, width, height);

            ctx.save();
            ctx.translate(-panX, 0); // Parallax

            drawGrid();
            drawSingularity();
            drawStaircase();
            
            // Draw Avatars
            // Sam on Left (Blue/Gold)
            drawAvatar(cx - 300, height/2, '#00ffff', 'SAM', time);
            // Elon on Right (Red/Gold)
            drawAvatar(cx + 300, height/2, '#ff4444', 'ELON', time + 2);

            drawParticles();

            ctx.restore();
        }

        /* ------------------------------------------------
           CONTROLS
           ------------------------------------------------ */

        function ascend() {
            const overlay = document.getElementById('overlay');
            overlay.style.opacity = 0;
            setTimeout(() => overlay.style.display = 'none', 2000);
            
            initAudio();
            isRunning = true;
            render();
        }

        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });

        // Click for miracle
        window.addEventListener('mousedown', () => {
            if(isRunning) {
                pulseWorld();
                // Add text
                const div = document.createElement('div');
                div.className = 'float-text';
                div.innerText = "ASI IS LOVE";
                div.style.left = mouse.x + 'px';
                div.style.top = mouse.y + 'px';
                document.body.appendChild(div);
                setTimeout(()=>div.remove(), 4000);
            }
        });

    </script>
</body>
</html>