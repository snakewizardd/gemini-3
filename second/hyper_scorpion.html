<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HYPER // SCORPION</title>
    <style>
        body {
            margin: 0;
            background-color: #000;
            overflow: hidden;
            font-family: 'Courier New', monospace;
            cursor: crosshair;
        }

        canvas {
            position: absolute;
            top: 0; left: 0;
            z-index: 1;
        }

        /* THE UI */
        #ui-layer {
            position: absolute;
            z-index: 10;
            width: 100%; height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, rgba(0,0,0,0) 0%, #000 100%);
            transition: opacity 1s;
        }

        .hud-box {
            text-align: center;
            border: 1px solid #00ffcc;
            padding: 40px;
            background: rgba(0, 10, 20, 0.9);
            box-shadow: 0 0 50px #00ffcc;
            animation: float 3s infinite ease-in-out;
        }

        h1 {
            color: #fff;
            font-size: 3rem;
            margin: 0 0 20px 0;
            text-transform: uppercase;
            letter-spacing: 10px;
            text-shadow: 0 0 20px #00ffcc;
        }

        button {
            background: transparent;
            color: #00ffcc;
            font-family: inherit;
            font-size: 1.5rem;
            padding: 15px 40px;
            border: 2px solid #00ffcc;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.2s;
        }
        button:hover {
            background: #00ffcc;
            color: #000;
            box-shadow: 0 0 30px #00ffcc;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        #stats {
            position: absolute;
            bottom: 20px; left: 20px;
            color: rgba(0, 255, 204, 0.6);
            font-size: 12px;
            pointer-events: none;
            z-index: 5;
        }

    </style>
</head>
<body>

    <canvas id="void"></canvas>
    
    <div id="ui-layer">
        <div class="hud-box">
            <h1>STARLIGHT SCORPION</h1>
            <button onclick="initiate()">SUMMON ENTITY</button>
        </div>
    </div>

    <div id="stats">
        FRACTAL_DEPTH: <span id="depth-val">0</span><br>
        AUDIO_CORE: <span id="audio-val">OFFLINE</span>
    </div>

    <script>
        const canvas = document.getElementById('void');
        const ctx = canvas.getContext('2d', { alpha: false });

        let width, height, cx, cy;
        let time = 0;
        let isRunning = false;
        let mouse = { x: 0.5, y: 0.5 }; // Normalized 0-1

        // FRACTAL CONFIG
        const MAX_DEPTH = 5;
        const BRANCHES = 6;
        
        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            cx = width / 2;
            cy = height / 2;
        }
        window.addEventListener('resize', resize);
        resize();

        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX / width;
            mouse.y = e.clientY / height;
        });

        /* ------------------------------------------------
           AUDIO ENGINE: HYPER-FM
           ------------------------------------------------ */
        const AC = window.AudioContext || window.webkitAudioContext;
        let actx, master;
        let sequencerTimer;
        let step = 0;

        // A exotic scale (Phrygian Dominant + Chromatic)
        const SCALE = [110, 123.47, 138.59, 146.83, 164.81, 174.61, 196.00, 220.00];

        function initAudio() {
            actx = new AC();
            master = actx.createGain();
            master.gain.value = 0.4;
            
            // Ping Pong Delay
            const delay = actx.createDelay();
            delay.delayTime.value = 0.2;
            const feedback = actx.createGain();
            feedback.gain.value = 0.5;
            
            master.connect(delay);
            delay.connect(feedback);
            feedback.connect(delay);
            delay.connect(actx.destination);
            master.connect(actx.destination);

            document.getElementById('audio-val').innerText = "ONLINE // FM_SYNTH";
            
            // Start Sequencer
            playSequence();
        }

        function playTone(freq, dur, type) {
            const t = actx.currentTime;
            const osc = actx.createOscillator();
            const mod = actx.createOscillator();
            const modGain = actx.createGain();
            const gain = actx.createGain();

            // FM CONFIG
            osc.type = 'sine';
            osc.frequency.value = freq;

            mod.type = 'sawtooth'; // Aggressive modulator
            // Modulator Ratio changes with Mouse X (Mutation)
            const ratio = 2 + (mouse.x * 4); 
            mod.frequency.value = freq * ratio;
            
            // FM Index changes with Mouse Y (Rage)
            modGain.gain.value = mouse.y * 1000; 

            gain.gain.setValueAtTime(0, t);
            gain.gain.linearRampToValueAtTime(0.2, t + 0.01);
            gain.gain.exponentialRampToValueAtTime(0.001, t + dur);

            mod.connect(modGain);
            modGain.connect(osc.frequency);
            osc.connect(gain);
            gain.connect(master);

            osc.start(t); mod.start(t);
            osc.stop(t + dur); mod.stop(t + dur);
        }

        function playSequence() {
            const bpm = 150 + (mouse.y * 100);
            const stepTime = 60 / bpm / 4; // 16th notes

            // Bass Pulse
            if (step % 4 === 0) playTone(55, 0.5, 'bass');
            
            // Arp
            const noteIdx = Math.floor((step + (mouse.x * 10)) % SCALE.length);
            if (Math.random() > 0.2) {
                playTone(SCALE[noteIdx] * (step%8===0 ? 0.5 : 2), 0.2, 'lead');
            }

            step++;
            setTimeout(playSequence, stepTime * 1000);
        }

        /* ------------------------------------------------
           VISUAL ENGINE: RECURSIVE SCORPION GEOMETRY
           ------------------------------------------------ */

        function drawFractalArm(x, y, len, angle, depth) {
            if (depth === 0) return;

            // Calculate End Point
            const ex = x + Math.cos(angle) * len;
            const ey = y + Math.sin(angle) * len;

            // Dynamic Width
            const w = depth * 2;

            // DRAW CRYSTAL SEGMENT
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(ex, ey);
            
            // Color: Shift hue based on depth and time
            const hue = (time * 50) + (depth * 40) + (mouse.x * 100);
            ctx.strokeStyle = `hsl(${hue}, 100%, 60%)`;
            ctx.lineWidth = w;
            ctx.stroke();

            // JOINTS (Glowing Orbs)
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(ex, ey, w, 0, Math.PI*2);
            ctx.fill();

            // RECURSION LOGIC (The Mutation)
            // We branch out based on Mouse X (DNA)
            const spread = 0.5 + (mouse.x * 1.0); 
            const shrink = 0.7;
            
            // Left Claw
            drawFractalArm(ex, ey, len * shrink, angle - spread + Math.sin(time)*0.1, depth - 1);
            // Right Claw
            drawFractalArm(ex, ey, len * shrink, angle + spread + Math.cos(time)*0.1, depth - 1);
        }

        function drawScorpion() {
            // Breathe
            const pulse = 1 + Math.sin(time * 5) * 0.1;
            
            // Use Additive Blending for Neon Glow
            ctx.globalCompositeOperation = 'lighter';
            
            // Draw Multiple Arms radially to create the "Face"
            const arms = 8;
            for(let i=0; i<arms; i++) {
                const angle = (i / arms) * Math.PI * 2;
                const rotation = time * 0.2; // Spin
                
                drawFractalArm(
                    cx, cy, 
                    100 * pulse, 
                    angle + rotation, 
                    MAX_DEPTH
                );
            }
            
            // Draw The Singularity Core
            ctx.shadowBlur = 50 + (mouse.y * 100);
            ctx.shadowColor = '#00ffcc';
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(cx, cy, 30 * pulse, 0, Math.PI*2);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        function drawParticles() {
            // Starfield / Dust
            ctx.fillStyle = '#fff';
            const speed = 10 + (mouse.y * 50);
            
            for(let i=0; i<50; i++) {
                const angle = Math.random() * Math.PI * 2;
                const dist = (time * speed * 10 + (i * 50)) % (width/1.5);
                const px = cx + Math.cos(angle) * dist;
                const py = cy + Math.sin(angle) * dist;
                const size = (dist / width) * 5;
                
                ctx.globalAlpha = dist / (width/2);
                ctx.fillRect(px, py, size, size);
            }
            ctx.globalAlpha = 1.0;
        }

        function render() {
            if (!isRunning) return;
            requestAnimationFrame(render);
            
            time += 0.02 + (mouse.y * 0.05);

            // CHROMATIC ABERRATION TRICK
            // We draw the scene 3 times with slight offsets for R, G, B channels
            
            // 1. Clear
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // Heavy trail
            ctx.fillRect(0, 0, width, height);

            // 2. Draw Red Channel Offset
            ctx.save();
            ctx.translate(5, 0);
            ctx.globalAlpha = 0.7;
            // (In a real shader we'd mask channels, here we just tint by drawing order)
            drawScorpion(); 
            ctx.restore();

            // 3. Draw Blue Channel Offset
            ctx.save();
            ctx.translate(-5, 0);
            ctx.globalAlpha = 0.7;
            drawScorpion();
            ctx.restore();
            
            // 4. Particles
            drawParticles();

            // Update Stats
            document.getElementById('depth-val').innerText = (mouse.x * 100).toFixed(0) + "%";
        }

        function initiate() {
            const ui = document.getElementById('ui-layer');
            ui.style.opacity = 0;
            setTimeout(() => ui.style.display = 'none', 1000);
            
            initAudio();
            isRunning = true;
            render();
        }

    </script>
</body>
</html>